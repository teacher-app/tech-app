<!DOCTYPE html>
<html>
<head>
    <title>ุชุดุฎูุต ุงููุดููุฉ</title>
</head>
<body>
    <h2>๐ ุชุดุฎูุต ูุดููุฉ WebRTC</h2>
    
    <button onclick="testWebSocket()">1. ุงุฎุชุจุงุฑ ุงุชุตุงู WebSocket</button>
    <div id="wsResult"></div>
    
    <button onclick="testWebRTC()">2. ุงุฎุชุจุงุฑ WebRTC</button>
    <div id="webrtcResult"></div>
    
    <button onclick="testCamera()">3. ุงุฎุชุจุงุฑ ุงููุงููุฑุง</button>
    <div id="cameraResult"></div>
    
    <button onclick="checkServer()">4. ุงูุชุญูู ูู ุงูุณูุฑูุฑ</button>
    <div id="serverResult"></div>
    
    <h3>ูุชุงุฆุฌ ุงููุญุต:</h3>
    <pre id="results"></pre>

    <script>
        const results = document.getElementById('results');
        
        async function testWebSocket() {
            const wsResult = document.getElementById('wsResult');
            wsResult.innerHTML = 'โณ ุฌุงุฑู ุงูุงุฎุชุจุงุฑ...';
            
            try {
                // ุฌุฑุจ ุนุฏุฉ ุฎูุงุฏู
                const servers = [
                    'wss://cripanyt.onrender.com',
                    'ws://cripanyt.onrender.com:10000',
                    'wss://cripanyt.onrender.com:10000'
                ];
                
                let connected = false;
                let errorMsg = '';
                
                for (let server of servers) {
                    try {
                        const ws = new WebSocket(server);
                        
                        await new Promise((resolve, reject) => {
                            ws.onopen = () => {
                                connected = true;
                                ws.close();
                                resolve();
                            };
                            ws.onerror = () => {
                                reject(new Error(`ูุดู ุงูุงุชุตุงู ุจู ${server}`));
                            };
                            setTimeout(() => reject(new Error('ุงูุชูู ููุช ุงูุงูุชุธุงุฑ')), 5000);
                        });
                        
                        if (connected) {
                            wsResult.innerHTML = `โ ูุชุตู ุจู ${server}`;
                            logResult(`โ WebSocket: ูุชุตู ุจู ${server}`);
                            return;
                        }
                    } catch (e) {
                        errorMsg = e.message;
                    }
                }
                
                if (!connected) {
                    wsResult.innerHTML = `โ ูุดู ุงูุงุชุตุงู: ${errorMsg}`;
                    logResult(`โ WebSocket: ูุดู ุงูุงุชุตุงู`);
                }
                
            } catch (error) {
                wsResult.innerHTML = `โ ุฎุทุฃ: ${error.message}`;
                logResult(`โ WebSocket: ${error.message}`);
            }
        }
        
        async function testWebRTC() {
            const webrtcResult = document.getElementById('webrtcResult');
            webrtcResult.innerHTML = 'โณ ุฌุงุฑู ุงุฎุชุจุงุฑ WebRTC...';
            
            try {
                // ุชุญูู ูู ุฏุนู WebRTC
                if (!window.RTCPeerConnection) {
                    throw new Error('ุงููุชุตูุญ ูุง ูุฏุนู WebRTC');
                }
                
                // ุฅูุดุงุก ุงุชุตุงู ุงุฎุชุจุงุฑ
                const pc = new RTCPeerConnection({
                    iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]
                });
                
                // ุงุฎุชุจุงุฑ ICE
                pc.onicecandidate = (event) => {
                    if (event.candidate) {
                        logResult(`โ WebRTC ICE: ูุนูู`);
                    }
                };
                
                // ุฅูุดุงุก ุนุฑุถ ุงุฎุชุจุงุฑ
                const offer = await pc.createOffer();
                await pc.setLocalDescription(offer);
                
                webrtcResult.innerHTML = 'โ WebRTC ูุนูู ุจุดูู ุตุญูุญ';
                logResult('โ WebRTC: ูุนูู');
                
                pc.close();
                
            } catch (error) {
                webrtcResult.innerHTML = `โ ุฎุทุฃ ูู WebRTC: ${error.message}`;
                logResult(`โ WebRTC: ${error.message}`);
            }
        }
        
        async function testCamera() {
            const cameraResult = document.getElementById('cameraResult');
            cameraResult.innerHTML = 'โณ ุทูุจ ุฅุฐู ุงููุงููุฑุง...';
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: true, 
                    audio: true 
                });
                
                cameraResult.innerHTML = `โ ุงููุงููุฑุง ุชุนูู (${stream.getTracks().length} ุชุฑุงู)`;
                logResult('โ ุงููุงููุฑุง: ุชุนูู');
                
                stream.getTracks().forEach(track => track.stop());
                
            } catch (error) {
                cameraResult.innerHTML = `โ ุฎุทุฃ ูู ุงููุงููุฑุง: ${error.message}`;
                logResult(`โ ุงููุงููุฑุง: ${error.message}`);
            }
        }
        
        async function checkServer() {
            const serverResult = document.getElementById('serverResult');
            serverResult.innerHTML = 'โณ ุฌุงุฑู ุงูุชุญูู ูู ุงูุณูุฑูุฑ...';
            
            try {
                const response = await fetch('https://cripanyt.onrender.com', {
                    method: 'GET',
                    mode: 'no-cors'
                });
                
                serverResult.innerHTML = 'โ ุงูุณูุฑูุฑ ูุณุชุฌูุจ';
                logResult('โ ุงูุณูุฑูุฑ: ูุนูู');
                
            } catch (error) {
                serverResult.innerHTML = `โ ุฎุทุฃ ูู ุงูุณูุฑูุฑ: ${error.message}`;
                logResult(`โ ุงูุณูุฑูุฑ: ${error.message}`);
            }
        }
        
        function logResult(message) {
            results.innerHTML += new Date().toLocaleTimeString() + ' - ' + message + '\n';
        }
        
        // ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ุชููุงุฆูุงู
        window.onload = () => {
            setTimeout(testWebSocket, 1000);
            setTimeout(testWebRTC, 2000);
            setTimeout(testCamera, 3000);
            setTimeout(checkServer, 4000);
        };
    </script>
</body>
</html>
